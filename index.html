<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Visual strace</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div id="loader">
      <header id="repo-link">
        <a
          href="https://github.com/lhoursquentin/visual-strace"
          target="_blank"
        >
          Github repo
        </a>
        <button id="toggle-loader" title="minimize window">-</button>
      </header>

      <section id="loader-content">
        <p>
          Run:<br>
          <code>
            <input
              id="strace-cmd"
              type="text"
              value="strace -o strace.out -yqrfe clone,execve,fork,vfork,read,write "
              readonly
            >
            &lt;cmd&gt; [args]...
          </code>
        </p>
        <ul>
          <li>
            Paste the contents of the newly created <code>strace.out</code>
            file in the text area below
          </li>
          <li>
            Or load a strace file (using <code>strace -o</code>):
            <input id="strace-file-input" type="file">
          </li>
          <li>
            Or click <button id="load-example">here</button> to load an
            <a
              href="https://github.com/lhoursquentin/system-summary"
              target="_blank"
            >
              example
            </a>
          </li>
        </ul>
        <div id="run-form">
          <textarea
            id="strace-output"
            placeholder="strace output goes here"
            spellcheck="false"
          ></textarea>
          <button id="run" disabled>run</button>
        </div>
        <details>
          <summary>
            How to read the graph
          </summary>
          <ul>
            <li>
              Grey arrows represent father/children process relationships
              via <code>fork</code> (or similar) syscalls
            </li>
            <li>
              Orange arrows represent read and write syscalls, the origin
              process is the writer and the destination process is the reader
            </li>
            <li>
              Green dots are processes that ended with a zero exit code
            </li>
            <li>
              Red dots are processes that ended with a non-zero exit code,
              which is specified between parentheses
            </li>
            <li>
              Purple dots are processes that ended due to a signal,
              which is specified between parentheses
            </li>
            <li>
              Labels are either set with the process ID returned by a
              <code>fork</code> (or similar) syscall or with the basename of
              binary of a successful <code>execve</code>
            </li>
          </ul>
        </details>
      </section>
    </div>

    <div id="speed-controller">
      <label for="speed-slider">slow down factor</label>
      <input id="speed-slider" type="range">
      <input id="speed-value-input" type="number">
      <button id="pause-button">Pause</button>
    </div>

    <div id="cy"></div>

    <div id="cytoscape-link">
      Graph built with <a href="https://js.cytoscape.org/">Cytoscape.js</a>
    </div>

    <script src="./deps/cytoscape.min.js"></script>
    <script src="./example-strace-output.js"></script>
    <script src="./graph.js"></script>
    <script src="./loader.js"></script>
    <script src="./serializer.js"></script>
    <script src="./speed.js"></script>

  </body>
</html>
